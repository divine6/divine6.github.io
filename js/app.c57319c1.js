(function(t){function e(e){for(var n,s,r=e[0],c=e[1],l=e[2],u=0,v=[];u<r.length;u++)s=r[u],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&v.push(a[s][0]),a[s]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);d&&d(e);while(v.length)v.shift()();return o.push.apply(o,l||[]),i()}function i(){for(var t,e=0;e<o.length;e++){for(var i=o[e],n=!0,r=1;r<i.length;r++){var c=i[r];0!==a[c]&&(n=!1)}n&&(o.splice(e--,1),t=s(s.s=i[0]))}return t}var n={},a={app:0},o=[];function s(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=n,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var d=c;o.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"0e5c":function(t,e,i){},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("div",{staticClass:"uploadFacePic"},[i("main",{staticStyle:{margintop:"20px"}},[i("div",{staticClass:"btn",on:{click:t.openCamera}},[t._v("开启人脸采集")])]),i("input",{staticStyle:{display:"none"},attrs:{id:"file",type:"file",accept:"image/*",capture:"camera"}}),t.cameraShow?i("div",{staticStyle:{width:"100%",position:"fixed",left:"0",bottom:"0",top:"0",right:"0"}},[i("div",{staticStyle:{width:"100%",position:"fixed",left:"0",bottom:"90vh",top:"0",right:"0",background:"black"}}),i("video",{staticStyle:{height:"65vh",width:"100vw",position:"fixed",top:"10vh",left:"0"}}),i("div",{staticStyle:{width:"100%",position:"fixed",left:"0",bottom:"25vh",top:"10vh",right:"0"}},[1==t.status?i("img",{staticStyle:{width:"100%",height:"100%",opacity:"0.8"},attrs:{src:"https://fanyi-cdn.cdn.bcebos.com/static/translation/img/header/logo_e835568.png",alt:""}}):t._e(),2==t.status?i("img",{staticStyle:{width:"100%",height:"100%"},attrs:{src:t.imageUrl,alt:""}}):t._e()]),i("div",{staticClass:"control"},[1==t.status?i("div",{staticClass:"control_before"},[i("div",{staticClass:"control_before_top"},[t._v("照片")]),i("div",{staticClass:"control_before_bottom"},[i("div",{staticClass:"smaller",on:{click:function(e){t.cameraShow=!1}}},[t._v("取消")]),i("div",{staticClass:"smaller",on:{click:t.snapPhoto}},[t._v("拍照")]),i("div",{staticClass:"smaller",on:{click:function(e){t.front=!t.front}}},[t._v("使用照片")])])]):t._e(),2==t.status?i("div",{staticClass:"control_after"},[i("div",{staticClass:"smaller",on:{click:function(e){t.status=1}}},[t._v("重拍")]),i("div",{staticClass:"smaller",on:{click:function(e){return t.submitPhoto("custom")}}},[t._v("使用照片")])]):t._e()]),i("canvas",{attrs:{id:"mycanvas"}})]):t._e(),t.tipVisible?i("div",{staticClass:"tipinfo"},["ok"==t.tipInfo.result?i("div",{staticClass:"successContent"},[i("div",{staticClass:"title"},[t._v("采集成功")]),i("div",{staticClass:"info"},[t._v("恭喜您，完成人脸照片采集")]),i("div",{staticClass:"btn",on:{click:function(e){t.tipVisible=!1}}},[t._v(" "+t._s("返回"+t.btntext)+" ")])]):i("div",{staticClass:"failContent"},[i("div",{staticClass:"title"},[t._v("采集失败")]),i("div",{staticClass:"info"},[t._v(t._s(t.tipInfo.msg+",请重拍"))]),i("div",{staticClass:"btn",on:{click:function(e){t.tipVisible=!1}}},[t._v(" "+t._s("返回"+t.btntext)+" ")])])]):t._e()])])},o=[],s=(i("d3b7"),i("d9e2"),i("3ca3"),i("ddb0"),i("2b3d"),i("9861"),i("ac1f"),i("1276"),i("466d"),i("5cc6"),i("907a"),i("9a8c"),i("a975"),i("735e"),i("c1ac"),i("d139"),i("3a7b"),i("d5d6"),i("82f8"),i("e91f"),i("60bd"),i("5f96"),i("3280"),i("3fcc"),i("ca91"),i("25a1"),i("cd26"),i("3c5d"),i("2954"),i("649e"),i("219c"),i("170b"),i("b39a"),i("72f7"),{data:function(){return{type:"",cameraShow:!1,status:0,imageUrl:"",front:!0,tipVisible:!1,tipInfo:{result:"fail",msg:"采集人脸失败"},btntext:"",time:null,imageFile:""}},mounted:function(){},methods:{openCamera:function(){this.cameraShow=!0;var t={audio:!1,video:{facingMode:this.front?"user":"environment"}};void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(t){var e=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia;return e?new Promise((function(i,n){e.call(navigator,t,i,n)})):Promise.reject(new Error("getUserMedia is not implemented in this browser"))});var e=this;navigator.mediaDevices.getUserMedia(t).then((function(t){var i=document.querySelector("video");i.srcObject=t,i.onloadedmetadata=function(t){i.play()},e.status=1})).catch((function(t){console.log("nonono",t),e.originCamera()}))},snapPhoto:function(){var t=document.querySelector("#mycanvas"),e=document.querySelector("video");t.width=e.videoWidth,t.height=e.videoHeight,t.getContext("2d").drawImage(e,0,0),this.imageFile=this.canvasToFile(t);var i=new Promise((function(e,i){t.toBlob((function(t){var i=URL.createObjectURL(t);e(i)}))})),n=this;i.then((function(t){n.imageUrl=t,n.status=2}))},canvasToFile:function(t){var e=t.toDataURL("image/png"),i=e.split(","),n=i[0].match(/:(.*?);/)[1],a=atob(i[1]),o=a.length,s=new Uint8Array(o);while(o--)s[o]=a.charCodeAt(o);var r=new File([s],"phone.png",{type:n});return r},originCamera:function(){var t=this;this.cameraShow=!1;var e=new Promise((function(t,e){var i=document.getElementById("file");i.click(),i.onchange=function(i){i||e("empty");var n=i.target.files[0];t(n)}}));e.then((function(e){t.submitPhoto("origin",e)}))},submitPhoto:function(t,e){"origin"==t&&(this.imageFile=e),console.log("提交",this.imageFile),this.tipInfo.result="ok",this.cameraShow=!1,this.countdown()},countdown:function(){var t=this;clearInterval(this.time),this.tipVisible=!0;var e=3;this.btntext="("+e+"s)",this.time=setInterval((function(){e--,t.btntext="("+e+"s)",0==e&&(clearInterval(t.time),t.tipVisible=!1,t.btntext="")}),1e3)}}}),r=s,c=(i("ee37"),i("2877")),l=Object(c["a"])(r,a,o,!1,null,"6c1f813e",null),d=l.exports;n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(d)}}).$mount("#app")},ee37:function(t,e,i){"use strict";i("0e5c")}});
//# sourceMappingURL=app.c57319c1.js.map